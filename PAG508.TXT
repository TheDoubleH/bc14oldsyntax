OBJECT Page 508 Blanket Sales Order Subform
{
  OBJECT-PROPERTIES
  {
    Date=04/29/22;
    Time=12:00:00 PM;
    Version List=NAVW114.36,NAVNA14.36;
  }
  PROPERTIES
  {
    CaptionML=ENU=Lines;
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table37;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Document Type=FILTER(Blanket Order));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnInit=BEGIN
             SalesReceivablesSetup.GET;
             Currency.InitRoundingPrecision;
           END;

    OnOpenPage=BEGIN
                 SetDimensionsVisibility;
               END;

    OnFindRecord=BEGIN
                   DocumentTotals.SalesCheckAndClearTotals(Rec,xRec,TotalSalesLine,VATAmount,InvoiceDiscountAmount,InvoiceDiscountPct);
                   EXIT(FIND(Which));
                 END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                       CLEAR(DocumentTotals);
                     END;

    OnNewRecord=BEGIN
                  InitType;
                  CLEAR(ShortcutDimCode);
                END;

    OnModifyRecord=BEGIN
                     DocumentTotals.SalesCheckIfDocumentChanged(Rec,xRec);
                   END;

    OnDeleteRecord=BEGIN
                     DocumentTotals.SalesDocTotalsNotUpToDate;
                   END;

    OnAfterGetCurrRecord=BEGIN
                           GetTotalSalesHeader;
                           CalculateTotals;
                           UpdateEditableOnRow;
                         END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=ENU=&Line;
                      Image=Line }
      { 1903866504;2 ;ActionGroup;
                      CaptionML=ENU=Item Availability by;
                      Image=ItemAvailability }
      { 3       ;3   ;Action    ;
                      CaptionML=ENU=Event;
                      ToolTipML=ENU=View how the actual and the projected available balance of an item will develop over time according to supply and demand events.;
                      ApplicationArea=#Suite;
                      Image=Event;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByEvent)
                               END;
                                }
      { 1900544904;3 ;Action    ;
                      CaptionML=ENU=Period;
                      ToolTipML=ENU=View the projected quantity of the item over time according to time periods, such as day, week, or month.;
                      ApplicationArea=#Suite;
                      Image=Period;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByPeriod)
                               END;
                                }
      { 1901991304;3 ;Action    ;
                      CaptionML=ENU=Variant;
                      ToolTipML=ENU=View or edit the item's variants. Instead of setting up each color of an item as a separate item, you can set up the various colors as variants of the item.;
                      ApplicationArea=#Planning;
                      Image=ItemVariant;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByVariant)
                               END;
                                }
      { 1901652204;3 ;Action    ;
                      AccessByPermission=TableData 14=R;
                      CaptionML=ENU=Location;
                      ToolTipML=ENU=View the actual and projected quantity of the item per location.;
                      ApplicationArea=#Location;
                      Image=Warehouse;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByLocation)
                               END;
                                }
      { 25      ;3   ;Action    ;
                      CaptionML=ENU=BOM Level;
                      ToolTipML=ENU=View availability figures for items on bills of materials that show how many units of a parent item you can make based on the availability of child items.;
                      ApplicationArea=#Suite;
                      Image=BOMLevel;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByBOM)
                               END;
                                }
      { 1902740304;2 ;ActionGroup;
                      CaptionML=ENU=Unposted Lines;
                      Image=Order }
      { 1907075804;3 ;Action    ;
                      CaptionML=ENU=Orders;
                      ToolTipML=ENU=View related sales orders.;
                      ApplicationArea=#Suite;
                      Image=Document;
                      OnAction=BEGIN
                                 ShowOrders;
                               END;
                                }
      { 1900639404;3 ;Action    ;
                      CaptionML=ENU=Invoices;
                      ToolTipML=ENU=View a list of ongoing sales invoices for the order.;
                      ApplicationArea=#Suite;
                      Image=Invoice;
                      OnAction=BEGIN
                                 ShowInvoices;
                               END;
                                }
      { 1906421304;3 ;Action    ;
                      AccessByPermission=TableData 6660=R;
                      CaptionML=ENU=Return Orders;
                      ToolTipML=ENU=Open the list of ongoing return orders.;
                      ApplicationArea=#SalesReturnOrder;
                      Image=ReturnOrder;
                      OnAction=BEGIN
                                 ShowReturnOrders;
                               END;
                                }
      { 1900609704;3 ;Action    ;
                      CaptionML=ENU=Credit Memos;
                      ToolTipML=ENU=View a list of ongoing credit memos for the order.;
                      ApplicationArea=#Suite;
                      Image=CreditMemo;
                      OnAction=BEGIN
                                 ShowCreditMemos;
                               END;
                                }
      { 1904974904;2 ;ActionGroup;
                      CaptionML=ENU=Posted Lines;
                      Image=Post }
      { 1904945204;3 ;Action    ;
                      CaptionML=ENU=Shipments;
                      ToolTipML=ENU=View a list of ongoing sales shipments for the order.;
                      ApplicationArea=#Suite;
                      Image=Shipment;
                      OnAction=BEGIN
                                 ShowPostedOrders;
                               END;
                                }
      { 1901092104;3 ;Action    ;
                      CaptionML=ENU=Invoices;
                      ToolTipML=ENU=View a list of ongoing sales invoices for the order.;
                      ApplicationArea=#Suite;
                      Image=Invoice;
                      OnAction=BEGIN
                                 ShowPostedInvoices;
                               END;
                                }
      { 1903984904;3 ;Action    ;
                      AccessByPermission=TableData 6660=R;
                      CaptionML=ENU=Return Receipts;
                      ToolTipML=ENU=View a list of posted return receipts for the order.;
                      ApplicationArea=#Suite;
                      Image=ReturnReceipt;
                      OnAction=BEGIN
                                 ShowPostedReturnReceipts;
                               END;
                                }
      { 1901033504;3 ;Action    ;
                      CaptionML=ENU=Credit Memos;
                      ToolTipML=ENU=View a list of ongoing credit memos for the order.;
                      ApplicationArea=#Suite;
                      Image=CreditMemo;
                      OnAction=BEGIN
                                 ShowPostedCreditMemos;
                               END;
                                }
      { 1900186704;2 ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=ENU=Dimensions;
                      ToolTipML=ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                      ApplicationArea=#Dimensions;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Name=DocAttach;
                      CaptionML=ENU=Attachments;
                      ToolTipML=ENU=Add a file as an attachment. You can attach images as well as documents.;
                      ApplicationArea=#All;
                      Image=Attach;
                      OnAction=VAR
                                 DocumentAttachmentDetails@1000 : Page 1173;
                                 RecRef@1001 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 DocumentAttachmentDetails.OpenForRecRef(RecRef);
                                 DocumentAttachmentDetails.RUNMODAL;
                               END;
                                }
      { 1900978604;2 ;Action    ;
                      CaptionML=ENU=Co&mments;
                      ToolTipML=ENU=View or add comments for the record.;
                      ApplicationArea=#Comments;
                      Image=ViewComments;
                      OnAction=BEGIN
                                 ShowLineComments;
                               END;
                                }
      { 15      ;2   ;ActionGroup;
                      CaptionML=ENU=Assemble to Order;
                      ActionContainerType=NewDocumentItems;
                      Image=AssemblyBOM }
      { 5       ;3   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      CaptionML=ENU=Assemble-to-Order Lines;
                      ToolTipML=ENU=View any linked assembly order lines if the documents represents an assemble-to-order sale.;
                      ApplicationArea=#Assembly;
                      OnAction=BEGIN
                                 ShowAsmToOrderLines;
                               END;
                                }
      { 13      ;3   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      Ellipsis=Yes;
                      CaptionML=ENU=Roll Up &Price;
                      ToolTipML=ENU=Update the unit price of the assembly item according to any changes that you have made to the assembly components.;
                      ApplicationArea=#Assembly;
                      OnAction=BEGIN
                                 RollupAsmPrice;
                               END;
                                }
      { 9       ;3   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      Ellipsis=Yes;
                      CaptionML=ENU=Roll Up &Cost;
                      ToolTipML=ENU=Update the unit cost of the assembly item according to any changes that you have made to the assembly components.;
                      ApplicationArea=#Assembly;
                      OnAction=BEGIN
                                 RollUpAsmCost;
                               END;
                                }
      { 1901994904;2 ;Action    ;
                      Name=DocumentLineTracking;
                      CaptionML=ENU=Document &Line Tracking;
                      ToolTipML=ENU=View related open, posted, or archived documents or document lines.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Navigate;
                      OnAction=BEGIN
                                 ShowDocumentLineTracking;
                               END;
                                }
      { 23      ;1   ;ActionGroup;
                      CaptionML=ENU=F&unctions;
                      Image=Action }
      { 21      ;2   ;Action    ;
                      AccessByPermission=TableData 7002=R;
                      Ellipsis=Yes;
                      CaptionML=ENU=Get &Price;
                      ToolTipML=ENU=Insert the lowest possible price in the Unit Price field according to any special price that you have set up.;
                      ApplicationArea=#Suite;
                      Image=Price;
                      OnAction=BEGIN
                                 ShowPrices
                               END;
                                }
      { 19      ;2   ;Action    ;
                      AccessByPermission=TableData 7004=R;
                      Ellipsis=Yes;
                      CaptionML=ENU=Get Li&ne Discount;
                      ToolTipML=ENU=Insert the best possible discount in the Line Discount field according to any special discounts that you have set up.;
                      ApplicationArea=#Suite;
                      Image=LineDiscount;
                      OnAction=BEGIN
                                 ShowLineDisc
                               END;
                                }
      { 17      ;2   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      CaptionML=ENU=E&xplode BOM;
                      ToolTipML=ENU=Insert new lines for the components on the bill of materials, for example to sell the parent item as a kit. CAUTION: The line for the parent item will be deleted and represented by a description only. To undo, you must delete the component lines and add a line the parent item again.;
                      ApplicationArea=#Suite;
                      Image=ExplodeBOM;
                      OnAction=BEGIN
                                 ExplodeBOM;
                               END;
                                }
      { 11      ;2   ;Action    ;
                      AccessByPermission=TableData 279=R;
                      CaptionML=ENU=Insert &Ext. Text;
                      ToolTipML=ENU=Insert the extended item description that is set up for the item that is being processed on the line.;
                      ApplicationArea=#Suite;
                      Image=Text;
                      OnAction=BEGIN
                                 InsertExtendedText(TRUE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the line type.;
                ApplicationArea=#Suite;
                SourceExpr=Type;
                OnValidate=BEGIN
                             NoOnAfterValidate;
                             DeltaUpdateTotals;
                           END;
                            }

    { 4   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the number of the involved entry or record, according to the specified number series.;
                ApplicationArea=#Suite;
                SourceExpr="No.";
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                             NoOnAfterValidate;
                             DeltaUpdateTotals;
                           END;
                            }

    { 26  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the cross-referenced item number. If you enter a cross reference between yours and your vendor's or customer's item number, then this number will override the standard item number when you enter the cross-reference number on a sales or purchase document.;
                ApplicationArea=#Suite;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             CrossReferenceNoOnAfterValidat;
                             DeltaUpdateTotals;
                           END;

                OnLookup=BEGIN
                           CrossReferenceNoLookUp;
                           InsertExtendedText(FALSE);
                           DeltaUpdateTotals;
                           OnCrossReferenceNoOnLookup(Rec);
                         END;
                          }

    { 22  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the variant of the item on the line.;
                ApplicationArea=#Planning;
                SourceExpr="Variant Code";
                Visible=FALSE;
                OnValidate=BEGIN
                             VariantCodeOnAfterValidate;
                             DeltaUpdateTotals;
                           END;
                            }

    { 14  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the tax specification of the involved item or resource to link transactions made for this record with the appropriate general ledger account according to the tax posting setup.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE;
                OnValidate=BEGIN
                             DeltaUpdateTotals;
                           END;
                            }

    { 6   ;2   ;Field     ;
                ToolTipML=ENU=Specifies a description of the blanket sales order.;
                ApplicationArea=#Suite;
                SourceExpr=Description;
                OnValidate=BEGIN
                             DeltaUpdateTotals;
                           END;
                            }

    { 36  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the location from where inventory items to the customer on the sales document are to be shipped by default.;
                ApplicationArea=#Suite;
                SourceExpr="Location Code";
                OnValidate=BEGIN
                             LocationCodeOnAfterValidate;
                             DeltaUpdateTotals;
                           END;
                            }

    { 8   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the quantity of the sales order line.;
                ApplicationArea=#Suite;
                BlankZero=Yes;
                SourceExpr=Quantity;
                OnValidate=BEGIN
                             QuantityOnAfterValidate;
                             DeltaUpdateTotals;
                             IF SalesReceivablesSetup."Calc. Inv. Discount" AND (Quantity = 0) THEN
                               CurrPage.UPDATE(FALSE);
                           END;
                            }

    { 7   ;2   ;Field     ;
                ToolTipML=ENU=Specifies how many units of the blanket sales line quantity that you want to supply by assembly.;
                ApplicationArea=#Assembly;
                SourceExpr="Qty. to Assemble to Order";
                Visible=FALSE;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             CurrPage.UPDATE(TRUE);
                           END;

                OnDrillDown=BEGIN
                              ShowAsmToOrderLines;
                            END;
                             }

    { 42  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the work type code of the service line linked to this entry.;
                ApplicationArea=#Manufacturing;
                SourceExpr="Work Type Code";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=ENU=Specifies how each unit of the item or resource is measured, such as in pieces or hours. By default, the value in the Base Unit of Measure field on the item or resource card is inserted.;
                ApplicationArea=#Suite;
                SourceExpr="Unit of Measure Code";
                OnValidate=BEGIN
                             UnitofMeasureCodeOnAfterValida;
                             DeltaUpdateTotals;
                           END;
                            }

    { 46  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the name of the item or resource's unit of measure, such as piece or hour.;
                ApplicationArea=#Suite;
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the cost, in $, of one unit of the item or resource on the line.;
                ApplicationArea=#Suite;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                CaptionML=ENU=Sale Price Exists;
                ToolTipML=ENU=Specifies that there is a specific price for this customer. The sales prices can be seen in the Sales Prices window.;
                ApplicationArea=#Suite;
                SourceExpr=PriceExists;
                Visible=FALSE;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the price of one unit of the item or resource. You can enter a price manually or have it entered according to the Price/Profit Calculation field on the related card.;
                ApplicationArea=#Suite;
                BlankZero=Yes;
                SourceExpr="Unit Price";
                OnValidate=BEGIN
                             DeltaUpdateTotals;
                           END;
                            }

    { 1020002;2;Field     ;
                ToolTipML=ENU=Specifies if this vendor charges you sales tax for purchases.;
                SourceExpr="Tax Liable";
                Visible=FALSE;
                Editable=FALSE }

    { 1020004;2;Field     ;
                ToolTipML=ENU=Specifies the tax area that is used to calculate and post sales tax.;
                ApplicationArea=#Suite;
                SourceExpr="Tax Area Code";
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 1020006;2;Field     ;
                ToolTipML=ENU=Specifies the tax group code for the tax detail entry.;
                SourceExpr="Tax Group Code";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 16  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the discount percentage that is granted for the item on the line.;
                ApplicationArea=#Suite;
                BlankZero=Yes;
                SourceExpr="Line Discount %";
                OnValidate=BEGIN
                             DeltaUpdateTotals;
                           END;
                            }

    { 28  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the net amount, excluding any invoice discount amount, that must be paid for products on the line.;
                ApplicationArea=#Suite;
                BlankZero=Yes;
                SourceExpr="Line Amount";
                OnValidate=BEGIN
                             DeltaUpdateTotals;
                           END;
                            }

    { 1020000;2;Field     ;
                ToolTipML=ENU=Specifies the sum of the amounts in the Amount Including Tax fields on the associated sales lines.;
                SourceExpr="Amount Including VAT" }

    { 40  ;2   ;Field     ;
                CaptionML=ENU=Sales Line Disc. Exists;
                ToolTipML=ENU=Specifies that there is a specific discount for this customer. The sales line discounts can be seen in the Sales Line Discounts window.;
                ApplicationArea=#Suite;
                SourceExpr=LineDiscExists;
                Visible=FALSE;
                Editable=FALSE }

    { 52  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the discount amount that is granted for the item on the line.;
                ApplicationArea=#Suite;
                SourceExpr="Line Discount Amount";
                Visible=FALSE;
                OnValidate=BEGIN
                             DeltaUpdateTotals;
                           END;
                            }

    { 54  ;2   ;Field     ;
                ToolTipML=ENU=Specifies if the invoice line is included when the invoice discount is calculated.;
                ApplicationArea=#Suite;
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE;
                OnValidate=BEGIN
                             DeltaUpdateTotals;
                           END;
                            }

    { 18  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the quantity of items that remain to be shipped.;
                ApplicationArea=#Suite;
                BlankZero=Yes;
                SourceExpr="Qty. to Ship" }

    { 20  ;2   ;Field     ;
                ToolTipML=ENU=Specifies how many units of the item on the line have been posted as shipped.;
                ApplicationArea=#Suite;
                BlankZero=Yes;
                SourceExpr="Quantity Shipped" }

    { 24  ;2   ;Field     ;
                ToolTipML=ENU=Specifies how many units of the item on the line have been posted as invoiced.;
                ApplicationArea=#Suite;
                BlankZero=Yes;
                SourceExpr="Quantity Invoiced" }

    { 90  ;2   ;Field     ;
                ToolTipML=ENU=Specifies when items on the document are shipped or were shipped. A shipment date is usually calculated from a requested delivery date plus lead time.;
                ApplicationArea=#Suite;
                SourceExpr="Shipment Date" }

    { 32  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the code for Shortcut Dimension 1, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=DimVisible1 }

    { 34  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the code for Shortcut Dimension 2, which is one of two global dimension codes that you set up in the General Ledger Setup window.;
                ApplicationArea=#Dimensions;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=DimVisible2 }

    { 300 ;2   ;Field     ;
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=DimVisible3;
                OnValidate=BEGIN
                             ValidateShortcutDimension(3);
                           END;
                            }

    { 302 ;2   ;Field     ;
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=DimVisible4;
                OnValidate=BEGIN
                             ValidateShortcutDimension(4);
                           END;
                            }

    { 304 ;2   ;Field     ;
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=DimVisible5;
                OnValidate=BEGIN
                             ValidateShortcutDimension(5);
                           END;
                            }

    { 306 ;2   ;Field     ;
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=DimVisible6;
                OnValidate=BEGIN
                             ValidateShortcutDimension(6);
                           END;
                            }

    { 308 ;2   ;Field     ;
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=DimVisible7;
                OnValidate=BEGIN
                             ValidateShortcutDimension(7);
                           END;
                            }

    { 310 ;2   ;Field     ;
                ApplicationArea=#Dimensions;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=DimVisible8;
                OnValidate=BEGIN
                             ValidateShortcutDimension(8);
                           END;
                            }

    { 53  ;1   ;Group     ;
                GroupType=Group }

    { 49  ;2   ;Group     ;
                GroupType=Group }

    { 27  ;3   ;Field     ;
                Name=SubtotalExclVAT;
                CaptionML=ENU=Subtotal Excl. Tax;
                ToolTipML=ENU=Specifies the sum of the value in the Line Amount Excl. Tax field on all lines in the document.;
                ApplicationArea=#Suite;
                SourceExpr=TotalSalesLine."Line Amount";
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=DocumentTotals.GetTotalLineAmountWithVATAndCurrencyCaption(Currency.Code,TotalSalesHeader."Prices Including VAT");
                Editable=FALSE }

    { 48  ;3   ;Field     ;
                Name=Invoice Discount Amount;
                CaptionML=ENU=Invoice Discount Amount;
                ToolTipML=ENU=Specifies a discount amount that is deducted from the value in the Total Incl. Tax field.;
                ApplicationArea=#Suite;
                SourceExpr=InvoiceDiscountAmount;
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=DocumentTotals.GetInvoiceDiscAmountWithVATAndCurrencyCaption(FIELDCAPTION("Inv. Discount Amount"),Currency.Code);
                Editable=InvDiscAmountEditable;
                OnValidate=BEGIN
                             DocumentTotals.SalesDocTotalsNotUpToDate;
                             ValidateInvoiceDiscountAmount;
                           END;
                            }

    { 47  ;3   ;Field     ;
                Name=Invoice Disc. Pct.;
                CaptionML=ENU=Invoice Discount %;
                ToolTipML=ENU=Specifies a discount percentage that is granted if criteria that you have set up for the customer are met.;
                ApplicationArea=#Suite;
                DecimalPlaces=0:2;
                SourceExpr=InvoiceDiscountPct;
                Editable=InvDiscAmountEditable;
                OnValidate=BEGIN
                             DocumentTotals.SalesDocTotalsNotUpToDate;
                             AmountWithDiscountAllowed := DocumentTotals.CalcTotalSalesAmountOnlyDiscountAllowed(Rec);
                             InvoiceDiscountAmount := ROUND(AmountWithDiscountAllowed * InvoiceDiscountPct / 100,Currency."Amount Rounding Precision");
                             ValidateInvoiceDiscountAmount;
                           END;
                            }

    { 35  ;2   ;Group     ;
                GroupType=Group }

    { 33  ;3   ;Field     ;
                Name=Total Amount Excl. VAT;
                DrillDown=No;
                CaptionML=ENU=Total Amount Excl. Tax;
                ToolTipML=ENU=Specifies the sum of the value in the Line Amount Excl. Tax field on all lines in the document minus any discount amount in the Invoice Discount Amount field.;
                ApplicationArea=#Suite;
                SourceExpr=TotalSalesLine.Amount;
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=DocumentTotals.GetTotalExclVATCaption(Currency.Code);
                Editable=FALSE }

    { 31  ;3   ;Field     ;
                Name=Total VAT Amount;
                CaptionML=ENU=Total Tax;
                ToolTipML=ENU=Specifies the sum of tax amounts on all lines in the document.;
                ApplicationArea=#Suite;
                SourceExpr=VATAmount;
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=DocumentTotals.GetTotalVATCaption(Currency.Code);
                Editable=FALSE }

    { 29  ;3   ;Field     ;
                Name=Total Amount Incl. VAT;
                CaptionML=ENU=Total Amount Incl. Tax;
                ToolTipML=ENU=Specifies the sum of the value in the Line Amount Incl. Tax field on all lines in the document minus any discount amount in the Invoice Discount Amount field.;
                ApplicationArea=#Suite;
                SourceExpr=TotalSalesLine."Amount Including VAT";
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=DocumentTotals.GetTotalInclVATCaption(Currency.Code);
                Editable=FALSE }

  }
  CODE
  {
    VAR
      CurrentSalesLine@1005 : Record 37;
      SalesLine@1001 : Record 37;
      TotalSalesHeader@1014 : Record 36;
      TotalSalesLine@1013 : Record 37;
      SalesHeader@1000 : Record 36;
      Currency@1007 : Record 4;
      SalesReceivablesSetup@1026 : Record 311;
      TransferExtendedText@1002 : Codeunit 378;
      SalesPriceCalcMgt@1004 : Codeunit 7000;
      ItemAvailFormsMgt@1006 : Codeunit 353;
      SalesCalcDiscountByType@1017 : Codeunit 56;
      DocumentTotals@1016 : Codeunit 57;
      VATAmount@1015 : Decimal;
      InvoiceDiscountAmount@1010 : Decimal;
      InvoiceDiscountPct@1009 : Decimal;
      AmountWithDiscountAllowed@1011 : Decimal;
      ShortcutDimCode@1003 : ARRAY [8] OF Code[20];
      InvDiscAmountEditable@1012 : Boolean;
      DimVisible1@1024 : Boolean;
      DimVisible2@1023 : Boolean;
      DimVisible3@1022 : Boolean;
      DimVisible4@1021 : Boolean;
      DimVisible5@1020 : Boolean;
      DimVisible6@1019 : Boolean;
      DimVisible7@1018 : Boolean;
      DimVisible8@1008 : Boolean;
      UpdateInvDiscountQst@1025 : TextConst 'ENU=One or more lines have been invoiced. The discount distributed to invoiced lines will not be taken into account.\\Do you want to update the invoice discount?';

    [External]
    PROCEDURE ApproveCalcInvDisc@6();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Disc. (Yes/No)",Rec);
      DocumentTotals.SalesDocTotalsNotUpToDate;
    END;

    LOCAL PROCEDURE ValidateInvoiceDiscountAmount@30();
    VAR
      SalesHeader@1000 : Record 36;
      ConfirmManagement@1001 : Codeunit 27;
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      IF SalesHeader.InvoicedLineExists THEN
        IF NOT ConfirmManagement.ConfirmProcess(UpdateInvDiscountQst,TRUE) THEN
          EXIT;

      SalesCalcDiscountByType.ApplyInvDiscBasedOnAmt(InvoiceDiscountAmount,SalesHeader);
      DocumentTotals.SalesDocTotalsNotUpToDate;
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE ExplodeBOM@3();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Explode BOM",Rec);
      DocumentTotals.SalesDocTotalsNotUpToDate;
    END;

    [External]
    PROCEDURE InsertExtendedText@5(Unconditionally@1000 : Boolean);
    BEGIN
      OnBeforeInsertExtendedText(Rec);
      IF TransferExtendedText.SalesCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        COMMIT;
        TransferExtendedText.InsertSalesExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    [External]
    PROCEDURE UpdateForm@12(SetSaveRecord@1000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    LOCAL PROCEDURE GetTotalSalesHeader@21();
    BEGIN
      DocumentTotals.GetTotalSalesHeaderAndCurrency(Rec,TotalSalesHeader,Currency);
    END;

    LOCAL PROCEDURE CalculateTotals@28();
    BEGIN
      DocumentTotals.SalesCheckIfDocumentChanged(Rec,xRec);
      DocumentTotals.CalculateSalesSubPageTotals(TotalSalesHeader,TotalSalesLine,VATAmount,InvoiceDiscountAmount,InvoiceDiscountPct);
      DocumentTotals.RefreshSalesLine(Rec);
    END;

    LOCAL PROCEDURE DeltaUpdateTotals@1();
    BEGIN
      DocumentTotals.SalesDeltaUpdateTotals(Rec,xRec,TotalSalesLine,VATAmount,InvoiceDiscountAmount,InvoiceDiscountPct);
      IF "Line Amount" <> xRec."Line Amount" THEN
        SendLineInvoiceDiscountResetNotification;
    END;

    PROCEDURE ForceTotalsCalculation@32();
    BEGIN
      DocumentTotals.SalesDocTotalsNotUpToDate;
    END;

    LOCAL PROCEDURE UpdateEditableOnRow@8();
    BEGIN
      InvDiscAmountEditable := CurrPage.EDITABLE AND NOT SalesReceivablesSetup."Calc. Inv. Discount";
    END;

    LOCAL PROCEDURE ShowPrices@15();
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      CLEAR(SalesPriceCalcMgt);
      SalesPriceCalcMgt.GetSalesLinePrice(SalesHeader,Rec);
    END;

    LOCAL PROCEDURE ShowLineDisc@16();
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      CLEAR(SalesPriceCalcMgt);
      SalesPriceCalcMgt.GetSalesLineLineDisc(SalesHeader,Rec);
    END;

    LOCAL PROCEDURE ShowOrders@2();
    BEGIN
      CurrentSalesLine := Rec;
      SalesLine.RESET;
      SalesLine.SETCURRENTKEY("Document Type","Blanket Order No.","Blanket Order Line No.");
      SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Order);
      SalesLine.SETRANGE("Blanket Order No.",CurrentSalesLine."Document No.");
      SalesLine.SETRANGE("Blanket Order Line No.",CurrentSalesLine."Line No.");
      PAGE.RUNMODAL(PAGE::"Sales Lines",SalesLine);
    END;

    LOCAL PROCEDURE ShowInvoices@4();
    BEGIN
      CurrentSalesLine := Rec;
      SalesLine.RESET;
      SalesLine.SETCURRENTKEY("Document Type","Blanket Order No.","Blanket Order Line No.");
      SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Invoice);
      SalesLine.SETRANGE("Blanket Order No.",CurrentSalesLine."Document No.");
      SalesLine.SETRANGE("Blanket Order Line No.",CurrentSalesLine."Line No.");
      PAGE.RUNMODAL(PAGE::"Sales Lines",SalesLine);
    END;

    LOCAL PROCEDURE ShowReturnOrders@9();
    BEGIN
      CurrentSalesLine := Rec;
      SalesLine.RESET;
      SalesLine.SETCURRENTKEY("Document Type","Blanket Order No.","Blanket Order Line No.");
      SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::"Return Order");
      SalesLine.SETRANGE("Blanket Order No.",CurrentSalesLine."Document No.");
      SalesLine.SETRANGE("Blanket Order Line No.",CurrentSalesLine."Line No.");
      PAGE.RUNMODAL(PAGE::"Sales Lines",SalesLine);
    END;

    LOCAL PROCEDURE ShowCreditMemos@10();
    BEGIN
      CurrentSalesLine := Rec;
      SalesLine.RESET;
      SalesLine.SETCURRENTKEY("Document Type","Blanket Order No.","Blanket Order Line No.");
      SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::"Credit Memo");
      SalesLine.SETRANGE("Blanket Order No.",CurrentSalesLine."Document No.");
      SalesLine.SETRANGE("Blanket Order Line No.",CurrentSalesLine."Line No.");
      PAGE.RUNMODAL(PAGE::"Sales Lines",SalesLine);
    END;

    LOCAL PROCEDURE ShowPostedOrders@17();
    VAR
      SaleShptLine@1000 : Record 111;
    BEGIN
      CurrentSalesLine := Rec;
      SaleShptLine.RESET;
      SaleShptLine.SETCURRENTKEY("Blanket Order No.","Blanket Order Line No.");
      SaleShptLine.SETRANGE("Blanket Order No.",CurrentSalesLine."Document No.");
      SaleShptLine.SETRANGE("Blanket Order Line No.",CurrentSalesLine."Line No.");
      PAGE.RUNMODAL(PAGE::"Posted Sales Shipment Lines",SaleShptLine);
    END;

    LOCAL PROCEDURE ShowPostedInvoices@14();
    VAR
      SalesInvLine@1000 : Record 113;
    BEGIN
      CurrentSalesLine := Rec;
      SalesInvLine.RESET;
      SalesInvLine.SETCURRENTKEY("Blanket Order No.","Blanket Order Line No.");
      SalesInvLine.SETRANGE("Blanket Order No.",CurrentSalesLine."Document No.");
      SalesInvLine.SETRANGE("Blanket Order Line No.",CurrentSalesLine."Line No.");
      PAGE.RUNMODAL(PAGE::"Posted Sales Invoice Lines",SalesInvLine);
    END;

    LOCAL PROCEDURE ShowPostedReturnReceipts@13();
    VAR
      ReturnRcptLine@1000 : Record 6661;
    BEGIN
      CurrentSalesLine := Rec;
      ReturnRcptLine.RESET;
      ReturnRcptLine.SETCURRENTKEY("Blanket Order No.","Blanket Order Line No.");
      ReturnRcptLine.SETRANGE("Blanket Order No.",CurrentSalesLine."Document No.");
      ReturnRcptLine.SETRANGE("Blanket Order Line No.",CurrentSalesLine."Line No.");
      PAGE.RUNMODAL(PAGE::"Posted Return Receipt Lines",ReturnRcptLine);
    END;

    LOCAL PROCEDURE ShowPostedCreditMemos@11();
    VAR
      SalesCrMemoLine@1000 : Record 115;
    BEGIN
      CurrentSalesLine := Rec;
      SalesCrMemoLine.RESET;
      SalesCrMemoLine.SETCURRENTKEY("Blanket Order No.","Blanket Order Line No.");
      SalesCrMemoLine.SETRANGE("Blanket Order No.",CurrentSalesLine."Document No.");
      SalesCrMemoLine.SETRANGE("Blanket Order Line No.",CurrentSalesLine."Line No.");
      PAGE.RUNMODAL(PAGE::"Posted Sales Credit Memo Lines",SalesCrMemoLine);
    END;

    LOCAL PROCEDURE NoOnAfterValidate@19066594();
    BEGIN
      InsertExtendedText(FALSE);

      SaveAndAutoAsmToOrder;
    END;

    LOCAL PROCEDURE LocationCodeOnAfterValidate@20();
    BEGIN
      SaveAndAutoAsmToOrder;
    END;

    LOCAL PROCEDURE VariantCodeOnAfterValidate@19();
    BEGIN
      SaveAndAutoAsmToOrder;
    END;

    LOCAL PROCEDURE CrossReferenceNoOnAfterValidat@19048248();
    BEGIN
      InsertExtendedText(FALSE);
    END;

    LOCAL PROCEDURE QuantityOnAfterValidate@19032465();
    BEGIN
      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
      END;

      IF (Type = Type::Item) AND
         (Quantity <> xRec.Quantity)
      THEN
        CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE UnitofMeasureCodeOnAfterValida@19057939();
    BEGIN
      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
      END;
    END;

    LOCAL PROCEDURE SaveAndAutoAsmToOrder@23();
    BEGIN
      IF (Type = Type::Item) AND IsAsmToOrderRequired THEN BEGIN
        CurrPage.SAVERECORD;
        AutoAsmToOrder;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    [External]
    PROCEDURE ShowDocumentLineTracking@24();
    VAR
      DocumentLineTracking@1000 : Page 6560;
    BEGIN
      CLEAR(DocumentLineTracking);
      DocumentLineTracking.SetDoc(2,"Document No.","Line No.","Blanket Order No.","Blanket Order Line No.",'',0);
      DocumentLineTracking.RUNMODAL;
    END;

    PROCEDURE RedistributeTotalsOnAfterValidate@1020000();
    BEGIN
      CurrPage.SAVERECORD;

      DocumentTotals.SalesRedistributeInvoiceDiscountAmounts(Rec,VATAmount,TotalSalesLine);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE SetDimensionsVisibility@22();
    VAR
      DimMgt@1000 : Codeunit 408;
    BEGIN
      DimVisible1 := FALSE;
      DimVisible2 := FALSE;
      DimVisible3 := FALSE;
      DimVisible4 := FALSE;
      DimVisible5 := FALSE;
      DimVisible6 := FALSE;
      DimVisible7 := FALSE;
      DimVisible8 := FALSE;

      DimMgt.UseShortcutDims(
        DimVisible1,DimVisible2,DimVisible3,DimVisible4,DimVisible5,DimVisible6,DimVisible7,DimVisible8);

      CLEAR(DimMgt);
    END;

    LOCAL PROCEDURE ValidateShortcutDimension@25(DimIndex@1000 : Integer);
    VAR
      AssembleToOrderLink@1001 : Record 904;
    BEGIN
      ValidateShortcutDimCode(DimIndex,ShortcutDimCode[DimIndex]);
      AssembleToOrderLink.UpdateAsmDimFromSalesLine(Rec);

      OnAfterValidateShortcutDimCode(Rec,ShortcutDimCode,DimIndex);
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterValidateShortcutDimCode@27(VAR SalesLine@1000 : Record 37;VAR ShortcutDimCode@1001 : ARRAY [8] OF Code[20];DimIndex@1002 : Integer);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeInsertExtendedText@18(VAR SalesLine@1000 : Record 37);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnCrossReferenceNoOnLookup@7(VAR SalesLine@1000 : Record 37);
    BEGIN
    END;

    BEGIN
    END.
  }
}

